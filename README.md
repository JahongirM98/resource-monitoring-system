# üñ•Ô∏è Resource Monitoring System

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–±–æ—Ä–æ–º –º–µ—Ç—Ä–∏–∫, —Ñ–∏–∫—Å–∞—Ü–∏–µ–π –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.  
–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è.

---

## üöÄ –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **Backend:** Python 3.12, Django 5  
- **Database:** MySQL 8  
- **Broker:** Redis 7  
- **Async tasks:** Celery + Celery Beat  
- **Frontend:** HTML + Vanilla JavaScript (–±–µ–∑ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤)  
- **Docker Compose:** –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã  
- **Auth:** —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π middleware –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π Django-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏  

---

## ‚öôÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```text
Django (monitor_site)
‚îú‚îÄ‚îÄ monitoring/
‚îÇ   ‚îú‚îÄ‚îÄ models.py           # Machine, Metric, Incident
‚îÇ   ‚îú‚îÄ‚îÄ tasks.py            # –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∏ –∞–Ω–∞–ª–∏–∑ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ middleware.py       # –ö–∞—Å—Ç–æ–º–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ views.py            # API + web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login.html
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ incidents.html
‚îÇ   ‚îî‚îÄ‚îÄ urls.py
‚îú‚îÄ‚îÄ celery.py               # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Celery –∏ Beat
‚îú‚îÄ‚îÄ settings.py             # –ë–î, Redis, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∑–∞–¥–∞—á
‚îú‚îÄ‚îÄ docker-compose.yml      # MySQL + Redis + Django
‚îî‚îÄ‚îÄ README.md
```

---

## üß© –ó–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞

### **–ó–∞–¥–∞—á–∞ 1 ‚Äî –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö**
–§–æ–Ω–æ–≤—ã–π –æ–ø—Ä–æ—Å 30 —É–¥–∞–ª—ë–Ω–Ω—ã—Ö –º–∞—à–∏–Ω –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç.  
–ö–∞–∂–¥–∞—è –º–∞—à–∏–Ω–∞ –æ—Ç–≤–µ—á–∞–µ—Ç JSON-–º–µ—Ç—Ä–∏–∫–æ–π:
```json
{
  "cpu": 60,
  "mem": "30%",
  "disk": "43%",
  "uptime": "1d 2h 37m 6s"
}
```
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä —á–µ—Ä–µ–∑ Celery Beat (`fetch-every-15-min`)  
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤ –ë–î  
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–≤–æ—Ä–∫–µ—Ä—ã –º–æ–∂–Ω–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å)  

---

### **–ó–∞–¥–∞—á–∞ 2 ‚Äî –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Ñ–∏–∫—Å–∞—Ü–∏—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤**
–ù–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ —Å–∏—Å—Ç–µ–º–∞ –≤—ã—è–≤–ª—è–µ—Ç –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã –ø–æ –ø–æ—Ä–æ–≥–∞–º:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ü–æ—Ä–æ–≥ | –£—Å–ª–æ–≤–∏–µ —Ñ–∏–∫—Å–∞—Ü–∏–∏ | –°—Ç–∞—Ç—É—Å |
|-----------|--------|-----------------|--------|
| CPU | > 85% | –æ–¥–Ω–æ–º–æ–º–µ–Ω—Ç–Ω–æ | ‚úÖ |
| MEM | > 90% | –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –º–∏–Ω—É—Ç | ‚úÖ |
| DISK | > 95% | –≤ —Ç–µ—á–µ–Ω–∏–µ 2 —á–∞—Å–æ–≤ | ‚úÖ |

‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏  
- –ù–µ–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤  
- –ê–≤—Ç–æ-–∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π  
- –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ shell  

---

### **–ó–∞–¥–∞—á–∞ 3 ‚Äî –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤.

‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- –ß–∏—Å—Ç—ã–π **vanilla JS** (–±–µ–∑ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤)  
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥  
- –ö–∞—Å—Ç–æ–º–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ `SimpleAuthMiddleware`  
- –¢–∞–±–ª–∏—Ü–∞ —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∏ –∑–∞–∫—Ä—ã—Ç—ã–º–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞–º–∏  
- –¶–≤–µ—Ç–æ–≤–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ (ACTIVE / RESOLVED)  

---

## üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

![–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤](docs/incidents_view.png)

---

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ middleware –∏ —Å–µ—Å—Å–∏–∏.

- –ê–¥—Ä–µ—Å –≤—Ö–æ–¥–∞: `/login`  
- –ê–¥—Ä–µ—Å –≤—ã—Ö–æ–¥–∞: `/logout`  
- –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –≤ `.env`:
  ```
  AUTH_USERNAME=admin
  AUTH_PASSWORD=admin123
  ```

–ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `/incidents`.

---

## üîÅ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–î–∞–Ω–Ω—ã–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥  
(—á–µ—Ä–µ–∑ `fetch('/api/incidents/json')`).

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª –≤—Ä—É—á–Ω—É—é

–ü—Ä–∏–º–µ—Ä—ã —Ä—É—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ Django shell:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ CPU
python manage.py shell -c "from monitoring.models import Machine, Metric; from django.utils import timezone as tz; m=Machine.objects.first(); Metric.objects.create(machine=m, cpu=99, mem_percent=10, disk_percent=10, uptime='test', received_at=tz.now())"

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ MEM
python manage.py shell -c "from monitoring.models import Machine, Metric; from django.utils import timezone as tz; from datetime import timedelta as td; m=Machine.objects.first(); now=tz.now(); Metric.objects.create(machine=m, mem_percent=95, received_at=now-td(minutes=15)); Metric.objects.create(machine=m, mem_percent=96, received_at=now)"

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ DISK
python manage.py shell -c "from monitoring.models import Machine, Metric; from django.utils import timezone as tz; from datetime import timedelta as td; m=Machine.objects.first(); now=tz.now(); [Metric.objects.create(machine=m, disk_percent=98, received_at=now-td(minutes=15*i)) for i in range(7,-1,-1)]"
```

---

## üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```bash
# –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose up --build -d

# –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
docker exec -it resource-monitoring-app python manage.py migrate
docker exec -it resource-monitoring-app python manage.py createsuperuser
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:
- Django web: [http://127.0.0.1:8000](http://127.0.0.1:8000)
- Redis: `localhost:6379`
- MySQL: `localhost:3307`
- –ê–¥–º–∏–Ω–∫–∞: `/admin`
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å: `/incidents`

---

## üß≠ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- Beat —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ:
  - `fetch-every-15-min` ‚Äî —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫
  - `evaluate-incidents-every-5-min` ‚Äî –∞–Ω–∞–ª–∏–∑ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤
- –°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –ø–∞–¥–µ–Ω–∏—é –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤.
- –ö–æ–¥ –æ—Ñ–æ—Ä–º–ª–µ–Ω –ø–æ PEP8, —Å —Ç–∏–ø–∞–º–∏ –∏ docstring‚Äô–∞–º–∏.

---

## üë§ –ê–≤—Ç–æ—Ä

**Jahongir Mirhalikov**  
üìç Khujand, Tajikistan  
üìß [mirhalikovj@gmail.com](mailto:mirhalikovj@gmail.com)  
üí¨ Telegram: [@mj4555](https://t.me/mj4555)  
üíª GitHub: [JahongirM98](https://github.com/JahongirM98)
